import http.client
import json

accounts = ["6107", "9431", "13742", "13743", "13744", "13745", "13746", "13747", "13748", "13749", "13750", "13751",
            "13752", "13753", "13754", "13755", "13757", "13758", "14185", "14186", "14189", "14190", "14196", "14200",
            "14202", "14204", "14205", "14206", "14210", "14211", "14213", "14214", "14215", "14216", "14217", "14219",
            "14220", "14221", "14223", "14224", "14225", "14226", "14228", "14230", "14231", "15152", "15153", "15156",
            "15158", "15159", "15160", "15161", "15162", "15163", "15164", "15166", "15167", "15169", "17397", "17399",
            "17401", "17402", "17403", "17404", "17405", "17406", "17410", "17412", "19058", "19059", "19060", "19061",
            "19408", "19736", "20126", "20127", "20129", "20234", "21179", "21180", "21181", "21182", "21183", "21190",
            "21191", "21378", "21379", "21380", "21382", "21383", "21384", "21449", "21450", "21489", "21490", "21671",
            "21709", "21710", "21711", "21712", "21713", "21714", "21715", "21716", "21717", "21718", "21719", "21721",
            "21722", "21723", "21724", "21725", "21726", "21728", "21729", "21730", "21731", "21732", "21733", "21734",
            "21735", "21736", "21737", "21738", "21739", "21740", "21742", "21899", "21900", "22267", "22359", "22589",
            "22849", "22870", "23038", "23041", "23104", "23107", "23108", "23109", "23110", "23111", "23113", "23126",
            "23129", "23131", "23133", "23134", "23146", "23147", "23152", "23153", "23154", "23157", "23158", "23159",
            "23161", "23226", "23232", "23292", "23346", "23389", "23392", "23555", "23598", "24036", "24042", "24122",
            "24123", "24132", "24226", "24458", "24461", "24498", "24499", "24503", "24730", "25392", "25394", "25654",
            "25655", "25656", "25659", "25660", "25661", "25748", "25749", "25751", "25857", "25878", "25879", "25880",
            "25881", "25882", "25883", "25884", "25886", "25888", "25890", "25891", "25892", "26464", "26465", "26466",
            "26467", "26476", "26642", "26645", "26676", "26677", "26753", "26810", "26946", "26950", "26951", "27033",
            "27034", "27035", "27142", "27747", "27825", "28012", "28129", "29425", "30750", "30918", "31205", "31206",
            "31207", "31208", "31209", "31246", "31257", "31433", "31842", "32282", "32284", "32589", "32636", "32640",
            "32645", "33325", "34233", "34235", "34236", "34237", "34263", "34340", "34406", "34529", "34537", "34538",
            "35014", "35015", "35016", "35032", "39202", "39209", "39394", "39404", "39406", "39427", "39437", "39572",
            "39573", "39574", "39575", "39576", "39577", "39578", "39579", "39580", "39581", "39582", "39583", "39584",
            "39585", "39586", "39587", "39588", "39589", "39590", "39591", "39592", "39593", "39594", "39595", "39596",
            "39597", "39598", "39599", "39600", "39601", "39602", "39603", "39604", "39605", "39606", "39607", "39608",
            "39609", "39610", "39612", "39613", "39614", "39615", "39617", "39864", "40081", "40139", "41698", "41704",
            "41998", "42003", "42008", "42035", "43381", "43382", "43383", "43390", "43391", "43393", "43530", "43531",
            "43533", "43535", "43536", "43537", "43795", "44209", "44218", "44219", "44231", "44432", "46796", "46797",
            "46818", "46915", "46916", "46917", "46918", "46919", "46922", "46926", "46928", "46929", "46930", "47427",
            "47443", "47449", "47503", "47505", "47506", "47512", "47514", "47598", "47609", "47616", "47617", "47639",
            "47640", "47681", "47736", "47739", "48015", "48026", "48027", "48161", "48164", "48165", "48200", "48201",
            "48237", "48244", "48595", "48833", "48946", "48947", "48948", "48953", "49023", "49025", "49085", "50557",
            "52550", "52571", "52573", "52597", "52702", "54345", "54347", "54348", "54357", "54358", "54359", "54364",
            "54365", "54367", "54368", "54369", "54370", "55147", "55173", "56234", "56235", "56236", "56237", "56388",
            "56395", "56396", "56405", "56413", "56855", "56877", "56878", "56960", "57191", "57244", "57365", "57367",
            "57754", "58110", "58125", "58126", "58128", "58129", "58130", "58131", "58179", "58180", "59436", "59442",
            "59450", "59452", "59454", "59465", "59547", "59548", "59562", "59563", "59641", "59642", "59688", "59692",
            "59836", "59837", "60001", "60059", "60077", "60155", "60167", "60168", "60169", "60170", "60171", "60172",
            "60173", "60174", "60912", "60963", "61705", "61706", "61708", "61834", "61860", "62003", "62004", "62006",
            "62007", "62008", "62009", "62010", "62012", "62013", "62623", "62756", "62761", "63113", "63131", "63489",
            "63790", "63895", "63960", "65003", "65005", "65054", "65066", "65125", "65126", "65129", "65151", "65230",
            "65243", "65244", "65409", "65413", "66110", "66111", "66165", "66916", "66919", "68537", "71562", "76988",
            "77585", "77592", "77599", "77612", "77615", "77619", "77621", "77640", "77641", "77670", "77672", "77693",
            "77694", "77695", "77696", "77697", "77698", "77699", "77701", "77712", "77719", "77783", "77785", "77787",
            "77802", "77803", "77806", "77813", "77836", "77837", "77851", "77977", "78088", "78189", "78271", "78320",
            "78321", "78322", "81667", "93885", "93900", "96023", "97762", "109021", "109198", "109776", "109778",
            "109779", "109781", "109782", "109783", "109784", "109785", "109790", "109805", "109809", "109815",
            "109835", "109837", "109838", "109839", "109841", "110084", "110086", "110087", "110088", "98501223",
            "98501869", "99000005", "99001831", "99001832", "99001875", "99001892", "99002138", "99002145", "99002152",
            "99002194", "99002648", "99002726", "99002727", "99002728", "99002729", "99002730", "99002731", "99002740",
            "99002741", "99002742", "99002743", "99002744", "99003070", "99003107", "99003108", "99003119", "99003120",
            "99004398", "99017899", "99017907", "99044611", "99044665", "99044947", "99045499", "99062346", "99062389",
            "99062405", "99063114", "99063680", "99066191", "99066192", "99066196", "99066223", "99066224", "99066251",
            "99066253", "99066255", "99066256", "99067568", "99067807", "99068010", "99267565", "99267566", "99269727",
            "99336128", "99336628", "99336792", "99337239", "99337240", "99507555", "99507593", "99507596", "99507601",
            "99507604", "99507605", "99507924", "99507925", "99507927", "99507928", "99507988", "99507993", "99508284",
            "99508289", "99508291", "99508545", "99508705", "99509418", "99509458", "99509593", "99509595", "99509796",
            "99509828", "99510715", "99512888", "99513533"]
requrl = "/chatmessage/_search/"
sum=0

def get_httpjson(n):
    test_data = {"query": {"bool": {
        "must": [{"range": {"MsgSendTime": {"gt": "2018-05-01 00:00:00", "lt": "2018-05-28 00:00:00"}}},
                 {"term": {"From_Account.raw": n}}], "must_not": [], "should": []}}, "from": 0, "size": 10, "sort": [],
        "aggs": {}}
    headerdata = {"Content-type": "application/json"}
    conn = http.client.HTTPConnection("172.17.14.148", 9200)
    conn.request('POST', requrl,json.dumps(test_data), headerdata)
    response = conn.getresponse()
    res = response.read().decode('utf-8')
    n = json.loads(res)
    num = (n['hits']['total'])
    return num

def get_result():
    for i in accounts:
        global sum
        sum+= get_httpjson(i)

# get_httpjson('99002152')
get_result()
print(sum)